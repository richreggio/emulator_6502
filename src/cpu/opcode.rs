use crate::cpu::addressing_mode::AddressingMode;

pub struct Opcode {
  opcode: u8,
  instruction_shorthand: String,
  addressing_mode: AddressingMode,
}

impl Opcode {
  fn new(opcode: u8, address: u8) -> Opcode {
    let (addressing_mode, instruction_shorthand) = resolve_opcode(opcode, address);
    let instruction_shorthand = instruction_shorthand.to_string();

    Opcode {
      opcode,
      instruction_shorthand,
      addressing_mode,
    }
  }
}

// EXHAUSTIVE list of opcodes
fn resolve_opcode(opcode: u8, address: u8) -> (AddressingMode, &'static str) {
  match opcode {
    0x00 => (AddressingMode::Implied, "BRK"),
    0x01 => (AddressingMode::ZeroPageXIndexIndirect(address), "ORA"),
    0x02 => (AddressingMode::Implied, "JAM"),
    0x03 => (AddressingMode::ZeroPageXIndexIndirect(address), "SLO"),
    0x04 => (AddressingMode::ZeroPage(address), "NOP"),
    0x05 => (AddressingMode::ZeroPage(address), "ORA"),
    0x06 => (AddressingMode::ZeroPage(address), "ASL"),
    0x07 => (AddressingMode::ZeroPage(address), "SLO"),
    0x08 => (AddressingMode::Implied, "PHP"),
    0x09 => (AddressingMode::Immediate(address), "ORA"),
    0x0A => (AddressingMode::Accumulator, "ASL"),
    0x0B => (AddressingMode::Immediate(address), "ANC"),
    0x0C => (AddressingMode::Absolute(address, address + 1), "NOP"),
    0x0D => (AddressingMode::Absolute(address, address + 1), "ORA"),
    0x0E => (AddressingMode::Absolute(address, address + 1), "ASL"),
    0x0F => (AddressingMode::Absolute(address, address + 1), "SLO"),
    0x10 => (AddressingMode::Relative(address), "BPL"),
    0x11 => (AddressingMode::ZeroPageYIndexIndirect(address), "ORA"),
    0x12 => (AddressingMode::Implied, "JAM"),
    0x13 => (AddressingMode::ZeroPageYIndexIndirect(address), "SLO"),
    0x14 => (AddressingMode::ZeroPageXIndex(address), "NOP"),
    0x15 => (AddressingMode::ZeroPageXIndex(address), "ORA"),
    0x16 => (AddressingMode::ZeroPageXIndex(address), "ASL"),
    0x17 => (AddressingMode::ZeroPageXIndex(address), "SLO"),
    0x18 => (AddressingMode::Implied, "CLC"),
    0x19 => (AddressingMode::AbsoluteYIndex(address, address + 1), "ORA"),
    0x1A => (AddressingMode::Implied, "NOP"),
    0x1B => (AddressingMode::AbsoluteYIndex(address, address + 1), "SLO"),
    0x1C => (AddressingMode::AbsoluteXIndex(address, address + 1), "NOP"),
    0x1D => (AddressingMode::AbsoluteXIndex(address, address + 1), "ORA"),
    0x1E => (AddressingMode::AbsoluteXIndex(address, address + 1), "ASL"),
    0x1F => (AddressingMode::AbsoluteXIndex(address, address + 1), "SLO"),
    0x20 => (AddressingMode::Absolute(address, address + 1), "JSR"),
    0x21 => (AddressingMode::ZeroPageXIndexIndirect(address), "AND"),
    0x22 => (AddressingMode::Implied, "JAM"),
    0x23 => (AddressingMode::ZeroPageXIndexIndirect(address), "RLA"),
    0x24 => (AddressingMode::ZeroPage(address), "BIT"),
    0x25 => (AddressingMode::ZeroPage(address), "AND"),
    0x26 => (AddressingMode::ZeroPage(address), "ROL"),
    0x27 => (AddressingMode::ZeroPage(address), "RLA"),
    0x28 => (AddressingMode::Implied, "PLP"),
    0x29 => (AddressingMode::Immediate(address), "AND"),
    0x2A => (AddressingMode::Accumulator, "ROL"),
    0x2B => (AddressingMode::Immediate(address), "ANC"),
    0x2C => (AddressingMode::Absolute(address, address + 1), "BIT"),
    0x2D => (AddressingMode::Absolute(address, address + 1), "AND"),
    0x2E => (AddressingMode::Absolute(address, address + 1), "ROL"),
    0x2F => (AddressingMode::Absolute(address, address + 1), "RLA"),
    0x30 => (AddressingMode::Relative(address), "BMI"),
    0x31 => (AddressingMode::ZeroPageYIndexIndirect(address), "AND"),
    0x32 => (AddressingMode::Implied, "JAM"),
    0x33 => (AddressingMode::ZeroPageYIndexIndirect(address), "RLA"),
    0x34 => (AddressingMode::ZeroPageXIndex(address), "NOP"),
    0x35 => (AddressingMode::ZeroPageXIndex(address), "AND"),
    0x36 => (AddressingMode::ZeroPageXIndex(address), "ROL"),
    0x37 => (AddressingMode::ZeroPageXIndex(address), "RLA"),
    0x38 => (AddressingMode::Implied, "SEC"),
    0x39 => (AddressingMode::AbsoluteYIndex(address, address + 1), "AND"),
    0x3A => (AddressingMode::Implied, "NOP"),
    0x3B => (AddressingMode::AbsoluteYIndex(address, address + 1), "RLA"),
    0x3C => (AddressingMode::AbsoluteXIndex(address, address + 1), "NOP"),
    0x3D => (AddressingMode::AbsoluteXIndex(address, address + 1), "AND"),
    0x3E => (AddressingMode::AbsoluteXIndex(address, address + 1), "ROL"),
    0x3F => (AddressingMode::AbsoluteXIndex(address, address + 1), "RLA"),
    0x40 => (AddressingMode::Implied, "RTI"),
    0x41 => (AddressingMode::ZeroPageXIndexIndirect(address), "EOR"),
    0x42 => (AddressingMode::Implied, "JAM"),
    0x43 => (AddressingMode::ZeroPageXIndexIndirect(address), "SRE"),
    0x44 => (AddressingMode::ZeroPage(address), "NOP"),
    0x45 => (AddressingMode::ZeroPage(address), "EOR"),
    0x46 => (AddressingMode::ZeroPage(address), "LSR"),
    0x47 => (AddressingMode::ZeroPage(address), "SRE"),
    0x48 => (AddressingMode::Implied, "PHA"),
    0x49 => (AddressingMode::Immediate(address), "EOR"),
    0x4A => (AddressingMode::Accumulator, "LSR"),
    0x4B => (AddressingMode::Immediate(address), "ASR"),
    0x4C => (AddressingMode::Absolute(address, address + 1), "JMP"),
    0x4D => (AddressingMode::Absolute(address, address + 1), "EOR"),
    0x4E => (AddressingMode::Absolute(address, address + 1), "LSR"),
    0x4F => (AddressingMode::Absolute(address, address + 1), "SRE"),
    0x50 => (AddressingMode::Relative(address), "BVC"),
    0x51 => (AddressingMode::ZeroPageYIndexIndirect(address), "EOR"),
    0x52 => (AddressingMode::Implied, "JAM"),
    0x53 => (AddressingMode::ZeroPageYIndexIndirect(address), "SRE"),
    0x54 => (AddressingMode::ZeroPageXIndex(address), "NOP"),
    0x55 => (AddressingMode::ZeroPageXIndex(address), "EOR"),
    0x56 => (AddressingMode::ZeroPageXIndex(address), "LSR"),
    0x57 => (AddressingMode::ZeroPageXIndex(address), "SRE"),
    0x58 => (AddressingMode::Implied, "CLI"),
    0x59 => (AddressingMode::AbsoluteYIndex(address, address + 1), "EOR"),
    0x5A => (AddressingMode::Implied, "NOP"),
    0x5B => (AddressingMode::AbsoluteYIndex(address, address + 1), "SRE"),
    0x5C => (AddressingMode::AbsoluteXIndex(address, address + 1), "NOP"),
    0x5D => (AddressingMode::AbsoluteXIndex(address, address + 1), "EOR"),
    0x5E => (AddressingMode::AbsoluteXIndex(address, address + 1), "LSR"),
    0x5F => (AddressingMode::AbsoluteXIndex(address, address + 1), "SRE"),
    0x60 => (AddressingMode::Implied, "RTS"),
    0x61 => (AddressingMode::ZeroPageXIndexIndirect(address), "ADC"),
    0x62 => (AddressingMode::Implied, "JAM"),
    0x63 => (AddressingMode::ZeroPageXIndexIndirect(address), "RRA"),
    0x64 => (AddressingMode::ZeroPage(address), "NOP"),
    0x65 => (AddressingMode::ZeroPage(address), "ADC"),
    0x66 => (AddressingMode::ZeroPage(address), "ROR"),
    0x67 => (AddressingMode::ZeroPage(address), "RRA"),
    0x68 => (AddressingMode::Implied, "PLA"),
    0x69 => (AddressingMode::Immediate(address), "ADC"),
    0x6A => (AddressingMode::Accumulator, "ROR"),
    0x6B => (AddressingMode::Immediate(address), "ARR"),
    0x6C => (
      AddressingMode::AbsoluteIndirect(address, address + 1),
      "JMP",
    ),
    0x6D => (AddressingMode::Absolute(address, address + 1), "ADC"),
    0x6E => (AddressingMode::Absolute(address, address + 1), "ROR"),
    0x6F => (AddressingMode::Absolute(address, address + 1), "RRA"),
    0x70 => (AddressingMode::Relative(address), "BVS"),
    0x71 => (AddressingMode::ZeroPageYIndexIndirect(address), "ADC"),
    0x72 => (AddressingMode::Implied, "JAM"),
    0x73 => (AddressingMode::ZeroPageYIndexIndirect(address), "RRA"),
    0x74 => (AddressingMode::ZeroPageXIndex(address), "NOP"),
    0x75 => (AddressingMode::ZeroPageXIndex(address), "ADC"),
    0x76 => (AddressingMode::ZeroPageXIndex(address), "ROR"),
    0x77 => (AddressingMode::ZeroPageXIndex(address), "RRA"),
    0x78 => (AddressingMode::Implied, "SEI"),
    0x79 => (AddressingMode::AbsoluteYIndex(address, address + 1), "ADC"),
    0x7A => (AddressingMode::Implied, "NOP"),
    0x7B => (AddressingMode::AbsoluteYIndex(address, address + 1), "RRA"),
    0x7C => (AddressingMode::AbsoluteXIndex(address, address + 1), "NOP"),
    0x7D => (AddressingMode::AbsoluteXIndex(address, address + 1), "ADC"),
    0x7E => (AddressingMode::AbsoluteXIndex(address, address + 1), "ROR"),
    0x7F => (AddressingMode::AbsoluteXIndex(address, address + 1), "RRA"),
    0x80 => (AddressingMode::Immediate(address), "NOP"),
    0x81 => (AddressingMode::ZeroPageXIndexIndirect(address), "STA"),
    0x82 => (AddressingMode::Immediate(address), "NOP"),
    0x83 => (AddressingMode::ZeroPageXIndexIndirect(address), "SAX"),
    0x84 => (AddressingMode::ZeroPage(address), "STY"),
    0x85 => (AddressingMode::ZeroPage(address), "STA"),
    0x86 => (AddressingMode::ZeroPage(address), "STX"),
    0x87 => (AddressingMode::ZeroPage(address), "SAX"),
    0x88 => (AddressingMode::Implied, "DEY"),
    0x89 => (AddressingMode::Immediate(address), "NOP"),
    0x8A => (AddressingMode::Implied, "TXA"),
    0x8B => (AddressingMode::Immediate(address), "XAA"),
    0x8C => (AddressingMode::Absolute(address, address + 1), "STY"),
    0x8D => (AddressingMode::Absolute(address, address + 1), "STA"),
    0x8E => (AddressingMode::Absolute(address, address + 1), "STX"),
    0x8F => (AddressingMode::Absolute(address, address + 1), "SAX"),
    0x90 => (AddressingMode::Relative(address), "BCC"),
    0x91 => (AddressingMode::ZeroPageYIndexIndirect(address), "STA"),
    0x92 => (AddressingMode::Implied, "JAM"),
    0x93 => (AddressingMode::ZeroPageYIndexIndirect(address), "SHA"),
    0x94 => (AddressingMode::ZeroPageXIndex(address), "STY"),
    0x95 => (AddressingMode::ZeroPageXIndex(address), "STA"),
    0x96 => (AddressingMode::ZeroPageYIndex(address), "STX"),
    0x97 => (AddressingMode::ZeroPageYIndex(address), "SAX"),
    0x98 => (AddressingMode::Implied, "TYA"),
    0x99 => (AddressingMode::AbsoluteYIndex(address, address + 1), "STA"),
    0x9A => (AddressingMode::Implied, "TXS"),
    0x9B => (AddressingMode::AbsoluteYIndex(address, address + 1), "SHS"),
    0x9C => (AddressingMode::AbsoluteXIndex(address, address + 1), "SHY"),
    0x9D => (AddressingMode::AbsoluteXIndex(address, address + 1), "STA"),
    0x9E => (AddressingMode::AbsoluteYIndex(address, address + 1), "SHX"),
    0x9F => (AddressingMode::AbsoluteYIndex(address, address + 1), "SHA"),
    0xA0 => (AddressingMode::Immediate(address), "LDY"),
    0xA1 => (AddressingMode::ZeroPageXIndexIndirect(address), "LDA"),
    0xA2 => (AddressingMode::Immediate(address), "LDX"),
    0xA3 => (AddressingMode::ZeroPageXIndexIndirect(address), "LAX"),
    0xA4 => (AddressingMode::ZeroPage(address), "LDY"),
    0xA5 => (AddressingMode::ZeroPage(address), "LDA"),
    0xA6 => (AddressingMode::ZeroPage(address), "LDX"),
    0xA7 => (AddressingMode::ZeroPage(address), "LAX"),
    0xA8 => (AddressingMode::Implied, "TAY"),
    0xA9 => (AddressingMode::Immediate(address), "LDA"),
    0xAA => (AddressingMode::Implied, "TAX"),
    0xAB => (AddressingMode::Immediate(address), "LAX"),
    0xAC => (AddressingMode::Absolute(address, address + 1), "LDY"),
    0xAD => (AddressingMode::Absolute(address, address + 1), "LDA"),
    0xAE => (AddressingMode::Absolute(address, address + 1), "LDX"),
    0xAF => (AddressingMode::Absolute(address, address + 1), "LAX"),
    0xB0 => (AddressingMode::Relative(address), "BCS"),
    0xB1 => (AddressingMode::ZeroPageYIndexIndirect(address), "LDA"),
    0xB2 => (AddressingMode::Implied, "JAM"),
    0xB3 => (AddressingMode::ZeroPageYIndexIndirect(address), "LAX"),
    0xB4 => (AddressingMode::ZeroPageXIndex(address), "LDY"),
    0xB5 => (AddressingMode::ZeroPageXIndex(address), "LDA"),
    0xB6 => (AddressingMode::ZeroPageYIndex(address), "LDX"),
    0xB7 => (AddressingMode::ZeroPageYIndex(address), "LAX"),
    0xB8 => (AddressingMode::Implied, "CLV"),
    0xB9 => (AddressingMode::AbsoluteYIndex(address, address + 1), "LDA"),
    0xBA => (AddressingMode::Implied, "TSX"),
    0xBB => (AddressingMode::AbsoluteYIndex(address, address + 1), "LAS"),
    0xBC => (AddressingMode::AbsoluteXIndex(address, address + 1), "LDY"),
    0xBD => (AddressingMode::AbsoluteXIndex(address, address + 1), "LDA"),
    0xBE => (AddressingMode::AbsoluteYIndex(address, address + 1), "LDX"),
    0xBF => (AddressingMode::AbsoluteYIndex(address, address + 1), "LAX"),
    0xC0 => (AddressingMode::Immediate(address), "CPY"),
    0xC1 => (AddressingMode::ZeroPageXIndexIndirect(address), "CMP"),
    0xC2 => (AddressingMode::Immediate(address), "NOP"),
    0xC3 => (AddressingMode::ZeroPageXIndexIndirect(address), "DCP"),
    0xC4 => (AddressingMode::ZeroPage(address), "CPY"),
    0xC5 => (AddressingMode::ZeroPage(address), "CMP"),
    0xC6 => (AddressingMode::ZeroPage(address), "DEC"),
    0xC7 => (AddressingMode::ZeroPage(address), "DCP"),
    0xC8 => (AddressingMode::Implied, "INY"),
    0xC9 => (AddressingMode::Immediate(address), "CMP"),
    0xCA => (AddressingMode::Implied, "DEX"),
    0xCB => (AddressingMode::Immediate(address), "SBX"),
    0xCC => (AddressingMode::Absolute(address, address + 1), "CPY"),
    0xCD => (AddressingMode::Absolute(address, address + 1), "CMP"),
    0xCE => (AddressingMode::Absolute(address, address + 1), "DEC"),
    0xCF => (AddressingMode::Absolute(address, address + 1), "DCP"),
    0xD0 => (AddressingMode::Relative(address), "BNE"),
    0xD1 => (AddressingMode::ZeroPageYIndexIndirect(address), "CMP"),
    0xD2 => (AddressingMode::Implied, "JAM"),
    0xD3 => (AddressingMode::ZeroPageYIndexIndirect(address), "DCP"),
    0xD4 => (AddressingMode::ZeroPageXIndex(address), "NOP"),
    0xD5 => (AddressingMode::ZeroPageXIndex(address), "CMP"),
    0xD6 => (AddressingMode::ZeroPageXIndex(address), "DEC"),
    0xD7 => (AddressingMode::ZeroPageXIndex(address), "DCP"),
    0xD8 => (AddressingMode::Implied, "CLD"),
    0xD9 => (AddressingMode::AbsoluteYIndex(address, address + 1), "CMP"),
    0xDA => (AddressingMode::Implied, "NOP"),
    0xDB => (AddressingMode::AbsoluteYIndex(address, address + 1), "DCP"),
    0xDC => (AddressingMode::AbsoluteXIndex(address, address + 1), "NOP"),
    0xDD => (AddressingMode::AbsoluteXIndex(address, address + 1), "CMP"),
    0xDE => (AddressingMode::AbsoluteXIndex(address, address + 1), "DEC"),
    0xDF => (AddressingMode::AbsoluteXIndex(address, address + 1), "DCP"),
    0xE0 => (AddressingMode::Immediate(address), "CPX"),
    0xE1 => (AddressingMode::ZeroPageXIndexIndirect(address), "SBC"),
    0xE2 => (AddressingMode::Immediate(address), "NOP"),
    0xE3 => (AddressingMode::ZeroPageXIndexIndirect(address), "ISC"),
    0xE4 => (AddressingMode::ZeroPage(address), "CPX"),
    0xE5 => (AddressingMode::ZeroPage(address), "SBC"),
    0xE6 => (AddressingMode::ZeroPage(address), "INC"),
    0xE7 => (AddressingMode::ZeroPage(address), "ISC"),
    0xE8 => (AddressingMode::Implied, "INX"),
    0xE9 => (AddressingMode::Immediate(address), "SBC"),
    0xEA => (AddressingMode::Implied, "NOP"),
    0xEB => (AddressingMode::Immediate(address), "SBC"),
    0xEC => (AddressingMode::Absolute(address, address + 1), "CPX"),
    0xED => (AddressingMode::Absolute(address, address + 1), "SBC"),
    0xEE => (AddressingMode::Absolute(address, address + 1), "INC"),
    0xEF => (AddressingMode::Absolute(address, address + 1), "ISC"),
    0xF0 => (AddressingMode::Relative(address), "BEQ"),
    0xF1 => (AddressingMode::ZeroPageYIndexIndirect(address), "SBC"),
    0xF2 => (AddressingMode::Implied, "JAM"),
    0xF3 => (AddressingMode::ZeroPageYIndexIndirect(address), "ISC"),
    0xF4 => (AddressingMode::ZeroPageXIndex(address), "NOP"),
    0xF5 => (AddressingMode::ZeroPageXIndex(address), "SBC"),
    0xF6 => (AddressingMode::ZeroPageXIndex(address), "INC"),
    0xF7 => (AddressingMode::ZeroPageXIndex(address), "ISC"),
    0xF8 => (AddressingMode::Implied, "SED"),
    0xF9 => (AddressingMode::AbsoluteYIndex(address, address + 1), "SBC"),
    0xFA => (AddressingMode::Implied, "NOP"),
    0xFB => (AddressingMode::AbsoluteYIndex(address, address + 1), "ISC"),
    0xFC => (AddressingMode::AbsoluteXIndex(address, address + 1), "NOP"),
    0xFD => (AddressingMode::AbsoluteXIndex(address, address + 1), "SBC"),
    0xFE => (AddressingMode::AbsoluteXIndex(address, address + 1), "INC"),
    0xFF => (AddressingMode::AbsoluteXIndex(address, address + 1), "ISC"),
  }
}
